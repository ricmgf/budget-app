/* ============================================================
   Budget App — CSS v3.0 — Option C Premium Dark
   ============================================================ */
:root {
  --bg-primary: #f7f8fa; --bg-secondary: #ffffff; --bg-tertiary: #eef0f4;
  --bg-hover: #e8eaf0; --bg-active: #dce0e8;
  --text-primary: #1a1d23; --text-secondary: #5a6070; --text-tertiary: #8890a0; --text-inverse: #ffffff;
  --border-light: #e2e5eb; --border-medium: #ccd0d8;
  --accent: #2563eb; --accent-hover: #1d4ed8; --accent-light: #dbeafe; --accent-subtle: #eff6ff;
  --success: #16a34a; --success-light: #dcfce7; --warning: #d97706; --warning-light: #fef3c7;
  --danger: #dc2626; --danger-light: #fef2f2;
  --positive: #10b981; --negative: #ef4444;
  --font-sans: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
  --font-mono: 'JetBrains Mono', 'Fira Code', monospace;
  --text-xs: 11px; --text-sm: 13px; --text-base: 14px; --text-lg: 16px;
  --sp-1: 4px; --sp-2: 8px; --sp-3: 12px; --sp-4: 16px; --sp-5: 20px; --sp-6: 24px; --sp-8: 32px;
  --radius-sm: 6px; --radius-md: 10px; --radius-lg: 16px;
  --shadow-sm: 0 1px 2px rgba(0,0,0,0.05); --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1);
}
* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: var(--font-sans); background: var(--bg-primary); color: var(--text-primary); font-size: var(--text-base); -webkit-font-smoothing: antialiased; }

/* === SIDEBAR === */
.app-sidebar { transition: width 0.3s ease; overflow: hidden; overflow-y: auto; }
.sidebar-toggle-btn { display:flex; align-items:center; justify-content:center; width:100%; height:32px; margin-bottom:8px; background:none; border:none; cursor:pointer; font-size:20px; color:var(--text-secondary); border-radius:6px; transition:all .2s; flex-shrink:0; }
.sidebar-toggle-btn:hover { background:var(--bg-tertiary); color:var(--text-primary); }
.sidebar-brand { display:flex; align-items:center; gap:12px; margin-bottom:24px; padding:0 12px; }
.app-sidebar.collapsed { width:60px !important; }
.app-sidebar.collapsed .sidebar-label, .app-sidebar.collapsed .nav-label, .app-sidebar.collapsed .nav-section-label { display:none; }
.app-sidebar.collapsed .sidebar-brand { justify-content:center; padding:0; }
.app-sidebar.collapsed .nav-item { justify-content:center; padding:10px 8px; }
.app-sidebar.collapsed .nav-icon { margin-right:0; }
.nav-icon { margin-right:10px; font-size:16px; flex-shrink:0; }
.nav-label { white-space:nowrap; }
.nav-section-label { margin:20px 12px 8px; font-size:11px; font-weight:700; color:#94a3b8; text-transform:uppercase; letter-spacing:.05em; }

/* === SHARED === */
.card { background:var(--bg-secondary); border-radius:var(--radius-lg); padding:var(--sp-5); border:1px solid var(--border-light); box-shadow:var(--shadow-sm); }
.btn { display:inline-flex; align-items:center; justify-content:center; padding:var(--sp-2) var(--sp-4); border-radius:var(--radius-sm); font-weight:600; font-size:var(--text-sm); cursor:pointer; transition:all .2s; border:1px solid transparent; gap:var(--sp-2); }
.btn-primary { background:var(--accent); color:var(--text-inverse); }
.btn-primary:hover { background:var(--accent-hover); }
.btn-secondary { background:var(--bg-tertiary); color:var(--text-secondary); }
.btn-ghost { background:transparent; color:var(--text-secondary); }
.badge { display:inline-flex; align-items:center; padding:2px 8px; border-radius:4px; font-size:var(--text-xs); font-weight:700; text-transform:uppercase; }
.badge-danger { background:var(--danger-light); color:var(--danger); }
.data-table { width:100%; border-collapse:collapse; font-size:var(--text-sm); }
.data-table th { background:var(--bg-tertiary); padding:var(--sp-2) var(--sp-3); text-align:left; font-weight:700; color:var(--text-secondary); border-bottom:1px solid var(--border-medium); }
.data-table td { padding:var(--sp-2) var(--sp-3); border-bottom:1px solid var(--border-light); }
.input { width:100%; padding:var(--sp-2) var(--sp-3); border-radius:var(--radius-sm); border:1px solid var(--border-medium); background:var(--bg-secondary); font-family:inherit; font-size:var(--text-sm); outline:none; }
.input:focus { border-color:var(--accent); }
.flex { display:flex; } .flex-between { display:flex; justify-content:space-between; align-items:center; }
.gap-2 { gap:8px; } .gap-3 { gap:12px; } .mb-4 { margin-bottom:16px; } .mb-6 { margin-bottom:24px; }
.text-right { text-align:right; } .text-muted { color:var(--text-tertiary); } .text-sm { font-size:var(--text-sm); }

/* === TAGS/MULTISELECT === */
.tag-card { display:inline-block; background:var(--bg-tertiary); color:var(--text-secondary); padding:4px 12px; border-radius:20px; font-size:12px; font-weight:500; margin-right:4px; border:1px solid var(--border-light); }
.tag-ext  { display:inline-block; background:#ede9fe; color:#5b21b6; padding:3px 10px; border-radius:20px; font-size:11px; font-weight:600; margin:2px 3px 2px 0; border:1px solid #ddd6fe; }
.custom-multiselect { position:relative; }
.ms-display { width:100%; padding:8px 12px; border-radius:6px; border:1px solid var(--border-light); background:var(--bg-secondary); cursor:pointer; font-size:13px; color:var(--text-secondary); min-height:38px; display:flex; align-items:center; }
.ms-options { display:none; position:absolute; top:100%; left:0; right:0; background:var(--bg-secondary); border:1px solid var(--border-light); border-radius:8px; box-shadow:var(--shadow-md); z-index:100; margin-top:4px; padding:8px 0; }
.ms-options.active { display:block; }
.ms-option { display:flex; align-items:center; gap:8px; padding:8px 12px; cursor:pointer; font-size:13px; }
.ms-option:hover { background:var(--bg-tertiary); }

/* === SETTINGS TABS === */
.settings-tabs { display:flex; gap:32px; border-bottom:1px solid var(--border-light); margin-bottom:32px; }
.settings-tab { padding:12px 0; font-weight:700; font-size:14px; color:var(--text-secondary); border-bottom:2px solid transparent; cursor:pointer; background:none; border-top:none; border-left:none; border-right:none; font-family:inherit; letter-spacing:.02em; transition:color .2s; }
.settings-tab:hover { color:var(--text-primary); }
.settings-tab.active { color:var(--accent); border-bottom-color:var(--accent); }

/* === IMPORT === */
.import-dropzone { border:2px dashed var(--border-medium); border-radius:var(--radius-lg); padding:48px 24px; text-align:center; background:var(--bg-secondary); cursor:pointer; transition:all .2s; }
.import-dropzone:hover,.import-dropzone.dragover { border-color:var(--accent); background:var(--accent-subtle); }
.import-preview-table { width:100%; border-collapse:collapse; font-size:13px; margin-top:16px; }
.import-preview-table th { background:var(--bg-tertiary); padding:8px 12px; text-align:left; font-weight:700; font-size:11px; text-transform:uppercase; }
.import-preview-table td { padding:8px 12px; border-bottom:1px solid var(--border-light); }

/* ════════════════════════════════════════════════════════
   BUDGET GRID — Option C: Premium Dark + Yellow Column
   ════════════════════════════════════════════════════════ */

/* Bank Tabs — consistent with Settings */
.budget-bank-tabs { display:flex; gap:0; border-bottom:2px solid var(--border-light); margin-bottom:16px; align-items:center; }
.budget-bank-tab { padding:10px 20px; font-weight:600; font-size:13px; color:var(--text-secondary); border:none; background:none; cursor:pointer; font-family:inherit; white-space:nowrap; border-bottom:2px solid transparent; margin-bottom:-2px; transition:all .2s; }
.budget-bank-tab:hover { color:var(--text-primary); background:#f8fafc; }
.budget-bank-tab.active { color:var(--accent); border-bottom-color:var(--accent); }
.uncat-badge { margin-left:auto; padding:6px 14px; font-size:12px; font-weight:600; color:var(--danger); background:var(--danger-light); border-radius:20px; cursor:pointer; }
.uncat-badge:hover { background:#fecaca; }

/* Grid Container */
.budget-grid-wrap { overflow-x:auto; overflow-y:visible; border:1px solid var(--border-light); border-radius:10px; background:white; }
.budget-grid { width:max-content; min-width:100%; border-collapse:collapse; font-size:12px; }

/* ── HEADER: Dark premium ── */
.budget-grid thead th {
  background:#0f172a; color:#e2e8f0; padding:9px 6px; text-align:center;
  font-size:10px; text-transform:uppercase; letter-spacing:.06em; font-weight:700;
  border-right:1px solid #1e293b; position:sticky; top:0; z-index:2;
}
.budget-grid thead th.th-left {
  text-align:left; min-width:190px; position:sticky; left:0; z-index:4; background:#0f172a;
}
.budget-grid thead th.th-month { min-width:135px; }
.budget-grid thead .sub-hdr th {
  background:#1e293b; color:#64748b; padding:4px 6px; font-size:9px; font-weight:600;
  border-bottom:2px solid #334155; border-right:1px solid #334155;
}
.budget-grid thead .sub-hdr th.th-left { background:#1e293b; }

/* Current month header = gold */
.budget-grid thead th.cur-hdr { background:#facc15 !important; color:#1a1d23 !important; font-weight:800 !important; }
.budget-grid thead .sub-hdr th.cur-hdr { background:#fbbf24 !important; color:#78350f !important; }

/* Closed month header = grey */
.budget-grid thead th.closed-hdr { background:#475569 !important; color:#94a3b8 !important; }
.budget-grid thead .sub-hdr th.closed-hdr { background:#334155 !important; color:#64748b !important; }

/* Unclosed past month header = amber warning */
.budget-grid thead th.unclosed-hdr { background:#92400e !important; color:#fbbf24 !important; }

/* ── DATA ROWS ── */
.budget-grid tbody td {
  padding:6px 8px; text-align:right; border-bottom:1px solid #f1f3f5;
  font-variant-numeric:tabular-nums; font-size:12px; color:var(--text-primary);
}
.budget-grid tbody td.frozen {
  text-align:left; font-weight:500; color:#334155; position:sticky; left:0;
  background:white; z-index:1; border-right:1px solid var(--border-light);
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:220px; padding-left:12px;
}
.budget-grid tbody tr:hover td { background:#f7f8fa; }
.budget-grid tbody tr:hover td.frozen { background:#f7f8fa; }

/* Current month column = yellow */
.budget-grid tbody td.cur { background:#fef9c3 !important; }
.budget-grid tbody tr:hover td.cur { background:#fef08a !important; }

/* Closed month column = grey */
.budget-grid tbody td.closed { background:#f1f5f9 !important; color:#64748b !important; }
.budget-grid tbody tr:hover td.closed { background:#e2e8f0 !important; }

/* Uncategorized */
.budget-grid tbody tr.uncat td.frozen { border-left:3px solid var(--danger); }
.budget-grid tbody tr.uncat td.td-annual-plan,
.budget-grid tbody tr.uncat td.td-annual-real,
.budget-grid tbody tr.uncat td.td-right-name { border-left-color: var(--border-light) !important; }

/* ── SECTION HEADERS with inline actions ── */
.bg-section-hdr td {
  background:#f1f5f9; font-weight:700; font-size:11px; text-transform:uppercase;
  letter-spacing:.04em; padding:10px 12px; border-bottom:2px solid var(--accent);
  color:#0f172a;
}
.bg-section-hdr td.frozen { border-left:4px solid var(--accent); position:sticky; left:0; z-index:2; background:#f1f5f9; display:flex; justify-content:space-between; align-items:center; gap:8px; }
.bg-section-hdr td.sec-cell { background:#f1f5f9; border-bottom:2px solid var(--accent); }
.sec-name { font-weight:700; }
.sec-actions { font-size:11px; font-weight:500; text-transform:none; letter-spacing:0; }
.sec-actions a { color:#94a3b8; cursor:pointer; text-decoration:none; transition:color .15s; }
.sec-actions a:hover { color:var(--accent); }
.formula-sign { display:inline-block; width:14px; text-align:center; color:#94a3b8; font-weight:700; font-size:11px; margin-right:2px; }
.auto-tag { font-size:10px; margin-right:3px; opacity:0.6; }

/* Tarjeta collapsible rows */
.tarjeta-parent td.frozen { font-weight:600; }
.tarjeta-child td { background:#fafbfc !important; }
.tarjeta-child td.frozen { font-size:11px; color:var(--text-secondary); }
.collapse-toggle {
  display:inline-block; min-width:20px; font-size:14px; font-weight:600;
  color:var(--accent); cursor:pointer; padding:2px 6px 2px 0; text-align:center;
}
.collapse-toggle:hover { color:var(--accent-hover, #1d4ed8); }

/* Note indicator — Excel-style triangle */
.note-indicator {
  display:inline-block; font-size:10px; color:var(--accent); margin-left:4px;
  cursor:pointer; line-height:1; vertical-align:top; opacity:0.5;
  padding:2px 3px; /* larger click area */
}
.note-indicator:hover { opacity:1; }
.note-indicator.grey { color:#94a3b8; cursor:pointer; }

/* Global tooltip (positioned by JS) */
.bg-tooltip {
  position:fixed; z-index:9999; background:white; color:#1e293b;
  padding:10px 14px; border-radius:10px; font-size:12px; font-weight:400;
  max-width:340px; min-width:160px; white-space:pre-wrap; line-height:1.5;
  box-shadow:0 8px 24px rgba(0,0,0,.15); pointer-events:none; display:none;
  border:1px solid #e2e8f0;
}

/* ── Breakdown Modal ── */
.bd-modal-overlay { justify-content:center !important; align-items:center; }
.bd-modal {
  background:white; border-radius:16px; padding:24px;
  min-width:360px; max-width:600px; width:auto;
  box-shadow:0 20px 60px rgba(0,0,0,.2);
  max-height:80vh; display:flex; flex-direction:column;
}
.bd-modal-header {
  display:flex; justify-content:space-between; align-items:center; margin-bottom:16px;
}
.bd-modal-header h3 { margin:0; font-size:15px; font-weight:700; }
.bd-modal-close {
  background:none; border:none; font-size:18px; cursor:pointer;
  color:var(--text-secondary); padding:4px 8px;
}
.bd-modal-close:hover { color:var(--text-primary); }
.bd-modal-body { overflow-y:auto; flex:1; }
.bd-modal-table { width:100%; border-collapse:collapse; }
.bd-modal-table thead tr { background:#f8fafc; }
.bd-modal-table th {
  padding:8px 12px; text-align:left; font-size:11px; font-weight:600;
  color:#94a3b8; text-transform:uppercase; letter-spacing:0.5px; white-space:nowrap;
}
.bd-modal-table th.bd-amount { text-align:right; }
.bd-modal-table td { padding:8px 12px; border-bottom:1px solid #f1f3f5; font-size:12px; }
.bd-modal-table td.bd-date { white-space:nowrap; color:#64748b; }
.bd-modal-table td.bd-concept { max-width:300px; overflow:hidden; text-overflow:ellipsis; word-break:break-word; }
.bd-modal-table td.bd-amount { text-align:right; font-variant-numeric:tabular-nums; white-space:nowrap; }
.bd-modal-footer {
  border-top:2px solid #0f172a; margin-top:8px; padding-top:12px;
  display:flex; justify-content:space-between; align-items:center;
}
.bd-modal-footer span:first-child { font-weight:700; font-size:13px; color:#64748b; }
.bd-modal-total { font-weight:800; font-size:15px; font-variant-numeric:tabular-nums; }

/* ── TOTALS — Clean Lines (no background) ── */
.bg-total td { font-weight:700; background:white !important; border-top:1px solid #cbd5e1; border-bottom:1px solid #cbd5e1; font-size:12px; }
.bg-total td.frozen { background:white !important; position:sticky; left:0; z-index:2; border-right:1px solid var(--border-light); }
.bg-total td.cur { background:#fef9c3 !important; }

/* ── SUMMARY — Option B Subtle Band ── */
.bg-summ td { font-weight:600; font-size:12px; background:#eff6ff !important; color:#1e40af; border-bottom:1px solid #dbeafe; }
.bg-summ td.frozen { background:#eff6ff !important; position:sticky; left:0; z-index:2; border-right:1px solid #dbeafe; }
.bg-summ.row-total td { background:#dbeafe !important; font-weight:800; color:#1e3a8a; }
.bg-summ.row-total td.frozen { background:#dbeafe !important; }
.bg-summ.row-income td { color:#1e40af; }
.bg-summ.row-cashflow td { font-weight:700; }
.bg-summ.row-meta td { background:#f0f4ff !important; color:#475569; font-weight:500; }
.bg-summ.row-meta td.frozen { background:#f0f4ff !important; }

/* ── ENVÍO NECESARIO — premium dark band ── */
.bg-envio td { background:#0f172a !important; color:#e2e8f0 !important; font-weight:700; font-size:13px; letter-spacing:.02em; }
.bg-envio td.frozen { background:#0f172a !important; color:#fbbf24 !important; position:sticky; left:0; z-index:2; }
.bg-envio td.cur { background:#1e293b !important; color:#fbbf24 !important; font-weight:800; }

/* ── Sticky thead ── */
.budget-grid-wrap { position:relative; max-height:calc(100vh - 160px); overflow:auto; }
.budget-grid thead { position:sticky; top:0; z-index:5; }

/* Value colors */
.val-neg { color:var(--danger) !important; } .val-pos { color:var(--success) !important; }

/* ── EDITABLE CELLS ── */
.budget-grid td.editable { cursor:pointer; }
.budget-grid td.editable:hover { outline:1px solid var(--accent); outline-offset:-1px; }
.budget-grid td.editing { padding:0 !important; }
.budget-grid td.editing input {
  width:100%; height:100%; padding:6px 8px; border:2px solid var(--accent); border-radius:0;
  font-size:12px; font-family:inherit; text-align:right; font-variant-numeric:tabular-nums; outline:none;
}

/* ── DRAWER ── */
.budget-drawer-overlay { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,.3); z-index:1000; display:flex; justify-content:flex-end; }
.budget-drawer { width:380px; height:100%; background:white; box-shadow:-4px 0 20px rgba(0,0,0,.1); padding:24px; overflow-y:auto; }
.budget-drawer h3 { font-size:18px; font-weight:700; margin-bottom:20px; }
/* ── DRAWER ── */
.budget-drawer-overlay { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,.3); z-index:1000; display:flex; justify-content:flex-end; }
.budget-drawer { width:380px; height:100%; background:white; box-shadow:-4px 0 20px rgba(0,0,0,.1); padding:24px; overflow-y:auto; }
.budget-drawer h3 { font-size:18px; font-weight:700; margin-bottom:20px; }
/* Scope form labels ONLY — never touch labels inside dw-grp-preview-wrap */
.budget-drawer .dw-form-label { display:block; font-size:11px; font-weight:700; text-transform:uppercase; color:var(--text-secondary); margin-bottom:6px; margin-top:16px; }
.budget-drawer label:not(.dw-preview-item) { display:block; font-size:11px; font-weight:700; text-transform:uppercase; color:var(--text-secondary); margin-bottom:6px; margin-top:16px; }
/* Override for preview checkboxes — must be flex, normal case */
.dw-grp-preview-wrap label { display:flex !important; font-size:12px !important; font-weight:400 !important; text-transform:none !important; color:inherit !important; margin:0 0 3px !important; margin-top:0 !important; }
/* Form inputs — scoped away from group search inputs */
.budget-drawer .dw-form-section input, .budget-drawer .dw-form-section select { width:100%; padding:10px; border-radius:8px; border:1px solid var(--border-light); font-size:14px; font-family:inherit; }
.budget-drawer .dw-form-section input:focus, .budget-drawer .dw-form-section select:focus { border-color:var(--accent); outline:none; }
/* Fallback: inputs NOT inside the group section keep normal style */
.budget-drawer input:not(.dw-grp-add-input):not(.dw-grp-pattern-input), .budget-drawer select { width:100%; padding:10px; border-radius:8px; border:1px solid var(--border-light); font-size:14px; font-family:inherit; }
.budget-drawer input:not(.dw-grp-add-input):not(.dw-grp-pattern-input):focus, .budget-drawer select:focus { border-color:var(--accent); outline:none; }
/* Group editor inputs get their own compact style */
.dw-grp-add-input, .dw-grp-pattern-input { width:100%; padding:7px 10px; border-radius:6px; border:1px solid var(--border-light); font-size:12px; font-family:inherit; box-sizing:border-box; }
.dw-grp-add-input:focus, .dw-grp-pattern-input:focus { border-color:var(--accent); outline:none; }
/* Checkboxes inside preview — never inherit drawer width:100% */
.dw-grp-preview-wrap input[type=checkbox] { width:auto !important; padding:0 !important; border:none !important; }
.drawer-actions { display:flex; gap:12px; margin-top:24px; }
.drawer-actions button { flex:1; padding:12px; border-radius:8px; border:none; font-weight:700; font-size:14px; cursor:pointer; font-family:inherit; }

/* Drawer: Group editor section */
.dw-group-section { margin-top:20px; border-top:1px solid var(--border-light); padding-top:16px; }
.dw-group-header { display:flex; justify-content:space-between; align-items:center; cursor:pointer; padding:8px 0; font-size:13px; font-weight:600; color:var(--text-secondary); }
.dw-group-header:hover { color:var(--accent); }
.dw-group-chevron { font-size:10px; transition:transform .2s; }
.dw-grp-empty { font-size:11px; color:var(--text-tertiary); padding:8px 0; }
.dw-grp-group { border:1px solid var(--border-light); border-radius:8px; padding:10px; margin-bottom:10px; }
.dw-grp-group-hdr { display:flex; justify-content:space-between; align-items:center; margin-bottom:6px; }
.dw-grp-group-hdr strong { font-size:13px; color:var(--accent); }
.dw-grp-count { font-size:10px; color:var(--text-tertiary); }
.dw-grp-pattern { display:flex; align-items:center; gap:6px; padding:4px 8px; font-size:11px; background:var(--bg-tertiary); border-radius:4px; margin-bottom:3px; }
.dw-grp-pattern-text { flex:1; font-family:'SF Mono',monospace; font-size:11px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
.dw-grp-pattern-bank { font-size:9px; color:var(--text-tertiary); }
.dw-grp-del { background:none; border:none; color:var(--text-tertiary); cursor:pointer; font-size:13px; padding:0 2px; line-height:1; }
.dw-grp-del:hover { color:var(--danger); }
.dw-grp-add { display:flex; gap:4px; margin-top:4px; }
.dw-grp-add-input { flex:1; padding:4px 8px; border:1px dashed var(--border-light); border-radius:4px; font-size:11px; font-family:inherit; }
.dw-grp-add-input:focus { border-color:var(--accent); outline:none; border-style:solid; }
.dw-grp-add-btn { background:var(--accent); color:white; border:none; border-radius:6px; padding:7px 14px; cursor:pointer; font-size:14px; font-weight:700; flex-shrink:0; }
.dw-grp-add-btn:hover { opacity:.85; }
.dw-grp-new-section { margin-top:8px; }
.dw-grp-new-toggle { font-size:12px; color:var(--accent); font-weight:600; cursor:pointer; padding:6px 0; }
.dw-grp-new-toggle:hover { text-decoration:underline; }
.dw-grp-match-item { display:flex; align-items:center; gap:6px; padding:3px 6px; border-radius:4px; font-size:11px; cursor:default; }
.dw-grp-match-item:hover { background:var(--bg-tertiary); }
.dw-grp-match-name { flex:1; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
.dw-grp-match-amt { font-variant-numeric:tabular-nums; color:var(--text-secondary); font-size:10px; white-space:nowrap; }
.hidden { display:none !important; }

/* ── Button styles (unified) ── */
.btn-save, .btn-cancel, .btn-delete, .budget-drawer button.btn-save {
  border:none; border-radius:10px; padding:10px 24px; font-size:14px; font-weight:600;
  font-family:inherit; cursor:pointer; transition:all .15s;
}
.btn-save { background:var(--accent); color:white; }
.btn-save:hover { opacity:.9; }
.btn-cancel { background:var(--bg-tertiary); color:var(--text-secondary); }
.btn-cancel:hover { background:#e2e8f0; }
.btn-delete { background:#fef2f2; color:var(--danger); border:1px solid #fecaca; width:100%; margin-top:12px; }
.btn-delete:hover { background:#fee2e2; }

/* ── RULES PAGE ── */
.rules-group-card { background:white; border:1px solid var(--border-light); border-radius:10px; padding:16px; }
.rules-group-hdr { display:flex; justify-content:space-between; align-items:center; margin-bottom:4px; }
.rules-group-hdr strong { font-size:15px; color:var(--accent); }
.rules-group-actions { display:flex; gap:4px; }
.rules-edit-btn { background:none; border:none; cursor:pointer; font-size:14px; padding:2px 4px; color:var(--text-tertiary); }
.rules-edit-btn:hover { color:var(--accent); }
.rules-group-count { font-size:11px; color:var(--text-tertiary); display:block; margin-bottom:8px; }
.rules-pattern-row { display:flex; align-items:center; gap:8px; padding:5px 8px; background:var(--bg-tertiary); border-radius:5px; margin-bottom:4px; font-size:12px; }
.rules-pattern-row code { flex:1; font-size:11px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
.rules-pattern-bank { font-size:9px; color:var(--text-tertiary); }
.rules-del-btn { background:none; border:none; color:var(--text-tertiary); cursor:pointer; font-size:13px; padding:0 2px; }
.rules-del-btn:hover { color:var(--danger); }
.rules-add-row { display:flex; gap:4px; margin-top:6px; }
.rules-add-input { flex:1; padding:5px 8px; border:1px dashed var(--border-light); border-radius:5px; font-size:11px; font-family:inherit; }
.rules-add-input:focus { border-color:var(--accent); border-style:solid; outline:none; }
.rules-add-btn { background:var(--accent); color:white; border:none; border-radius:5px; width:28px; cursor:pointer; font-size:14px; font-weight:700; }
.rules-add-btn:hover { opacity:.85; }

/* ── Bank order buttons ── */
.bank-order-btn { background:none; border:1px solid var(--border-light); border-radius:4px; cursor:pointer; font-size:10px; padding:2px 6px; color:var(--text-secondary); transition:all .15s; }
.bank-order-btn:hover:not(:disabled) { background:var(--accent); color:white; border-color:var(--accent); }
.bank-order-btn:disabled { opacity:.3; cursor:default; }
.btn-save { background:var(--accent); color:white; }
.btn-cancel { background:var(--bg-tertiary); color:var(--text-secondary); }
.btn-delete { background:var(--danger-light); color:var(--danger); margin-top:12px; width:100%; padding:10px; border:none; border-radius:8px; cursor:pointer; font-weight:600; font-size:13px; font-family:inherit; }
/* ═══════════════════════════════════════════════════════
   DASHBOARD — Fase 2
   Añadir al final de app.css
   ═══════════════════════════════════════════════════════ */

/* ── Cabecera del dashboard ─────────────────────────── */
.dash-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 28px;
}
.dash-eyebrow {
  font-size: 11px;
  font-weight: 700;
  color: var(--text-secondary, #94a3b8);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  margin-bottom: 4px;
}
.dash-title {
  font-size: 24px;
  font-weight: 800;
  color: var(--text-primary, #0f172a);
  margin: 0;
}

/* ── Navegador de mes ───────────────────────────────── */
.dash-header .month-nav {
  display: flex;
  align-items: center;
  gap: 10px;
  background: white;
  border: 1px solid var(--border-light, #e2e8f0);
  border-radius: 10px;
  padding: 8px 16px;
  box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}
.dash-header .month-nav button {
  background: none;
  border: none;
  cursor: pointer;
  font-size: 18px;
  color: var(--text-secondary, #64748b);
  padding: 0 2px;
  line-height: 1;
  transition: color 0.1s;
}
.dash-header .month-nav button:hover { color: var(--text-primary, #0f172a); }
#month-display-dash {
  font-weight: 700;
  font-size: 15px;
  min-width: 140px;
  text-align: center;
  color: var(--text-primary, #0f172a);
}

/* ── Grid de tarjetas ───────────────────────────────── */
.dash-cards-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(290px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
}

/* ── Tarjeta de banco ───────────────────────────────── */
.dash-bank-card {
  background: white;
  border-radius: 14px;
  border: 1px solid var(--border-light, #e2e8f0);
  border-left: 4px solid var(--border-light, #e2e8f0);
  padding: 18px 20px;
  cursor: pointer;
  box-shadow: 0 1px 4px rgba(0,0,0,0.06);
  transition: box-shadow 0.15s, transform 0.1s;
}
.dash-bank-card:hover {
  box-shadow: 0 6px 20px rgba(0,0,0,0.10);
  transform: translateY(-2px);
}

/* Estados de tarjeta */
.dash-bank-card.sufficient {
  border-left-color: #10b981;
  background: #f0fdf4;
  border-color: #bbf7d0;
}
.dash-bank-card.needs-transfer {
  border-left-color: #2563eb;
}
.dash-bank-card.alert-missing {
  border-left-color: #ef4444;
  background: white;
  border-color: #e2e8f0;
}

/* Header de la tarjeta */
.dash-card-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 12px;
}
.dash-bank-name {
  font-size: 11px;
  font-weight: 700;
  color: var(--text-secondary, #64748b);
  text-transform: uppercase;
  letter-spacing: 0.06em;
  margin-bottom: 3px;
}
.dash-bank-iban {
  font-size: 10px;
  color: #94a3b8;
  font-family: monospace;
  letter-spacing: 0.03em;
}
.dash-card-arrow {
  font-size: 16px;
  color: #cbd5e1;
  transition: color 0.15s;
}
.dash-bank-card:hover .dash-card-arrow { color: var(--accent, #2563eb); }

/* Bloque de alertas de extractos */
/* Lista de extractos en card — nuevo sistema minimalista */
.dash-ext-list {
  list-style: none;
  padding: 0;
  margin: 0 0 12px 0;
}
.dash-ext-item {
  font-size: 12px;
  line-height: 1.5;
  margin-bottom: 3px;
  display: flex;
  align-items: baseline;
  gap: 4px;
}
.dash-ext-item:last-child { margin-bottom: 0; }
.ext-missing  { color: #dc2626; font-weight: 500; }
.ext-incomplete { color: #0f172a; }
.ext-ok       { color: #0f172a; }
.dash-ext-check { color: #10b981; font-weight: 700; flex-shrink: 0; }

/* Importe principal */
.dash-card-amount {
  font-size: 30px;
  font-weight: 800;
  font-variant-numeric: tabular-nums;
  margin-bottom: 3px;
  line-height: 1.1;
}

/* Texto de estado */
.dash-card-status {
  font-size: 12px;
  font-weight: 500;
}
.dash-card-status.green { color: #10b981; }
.dash-card-status.muted { color: var(--text-secondary, #64748b); }

/* Fecha límite */
.dash-card-deadline {
  font-size: 11px;
  color: #94a3b8;
  margin-top: 4px;
}

/* ── Barra de total ─────────────────────────────────── */
.dash-total-bar {
  background: #0f172a;
  border-radius: 14px;
  padding: 18px 24px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 16px;
}
.dash-total-label {
  font-size: 13px;
  font-weight: 600;
  color: #94a3b8;
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
}
.dash-alert-badge {
  font-size: 11px;
  font-weight: 700;
  color: #fbbf24;
  background: rgba(251,191,36,0.12);
  border: 1px solid rgba(251,191,36,0.3);
  padding: 2px 10px;
  border-radius: 20px;
}
.dash-total-amount {
  font-size: 28px;
  font-weight: 800;
  color: white;
  font-variant-numeric: tabular-nums;
  flex-shrink: 0;
}

/* ── Skeleton loader ────────────────────────────────── */
.dash-skeleton {
  min-height: 130px;
  background: linear-gradient(90deg, #f1f5f9 25%, #e8edf2 50%, #f1f5f9 75%);
  background-size: 200% 100%;
  animation: dashShimmer 1.4s ease-in-out infinite;
  pointer-events: none;
}
@keyframes dashShimmer {
  0%   { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

/* ── Error state ────────────────────────────────────── */
.dash-error {
  padding: 24px;
  color: var(--text-secondary, #64748b);
  display: flex;
  align-items: center;
  gap: 12px;
  background: white;
  border-radius: 14px;
  border: 1px solid var(--border-light, #e2e8f0);
}


/* ═══════════════════════════════════════════════════════
   TOP NAV — Fase 2 (reemplaza sidebar)
   ═══════════════════════════════════════════════════════ */

.app-topnav {
  position: sticky;
  top: 0;
  z-index: 100;
  height: 52px;
  background: white;
  border-bottom: 1px solid var(--border-light, #e2e8f0);
  box-shadow: 0 1px 3px rgba(0,0,0,0.06);
  display: flex;
  align-items: center;
  padding: 0 24px;
  gap: 4px;
  flex-shrink: 0;
}
.topnav-brand {
  display: flex;
  align-items: center;
  gap: 10px;
  font-weight: 800;
  font-size: 15px;
  color: #1e40af;
  margin-right: 20px;
  cursor: pointer;
  white-space: nowrap;
}
.topnav-brand img { width: 24px; height: 24px; }
.nav-tab {
  padding: 5px 13px;
  border-radius: 6px;
  border: none;
  background: none;
  color: var(--text-secondary, #64748b);
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  font-family: inherit;
  white-space: nowrap;
  transition: all 0.15s;
}
.nav-tab:hover { background: #f1f5f9; color: var(--text-primary, #0f172a); }
.nav-tab.active {
  background: #eff6ff;
  color: var(--accent, #2563eb);
  font-weight: 700;
}
/* ============================================================
   REPORTING MODULE — clean rewrite
   Structure: main-content.full-width > view-wrapper (max-width:none) > 
              reporting-content > rpt-wrap > rpt-sticky (sticky top:52px)
   ============================================================ */

/* Loading */
.rpt-load-text { font-size: 13px; font-weight: 600; color: var(--text-secondary); }
.spin { width: 28px; height: 28px; border: 3px solid var(--border-light); border-top-color: var(--accent); border-radius: 50%; animation: rpt-spin 0.7s linear infinite; }
@keyframes rpt-spin { to { transform: rotate(360deg); } }

/* ── Sticky header band ── */
.rpt-sticky {
  position: sticky;
  top: 0;   /* main-content scroll container starts directly below topnav */
  z-index: 50;
  background: white;
  border-bottom: 1px solid var(--border-light);
  box-shadow: 0 2px 8px rgba(0,0,0,.06);
}

/* ── Controls bar (title left, buttons right) ── */
.rpt-controls-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 10px 24px;
  flex-wrap: wrap;
  min-height: 48px;
}
.rpt-toolbar-title { font-size: 14px; font-weight: 700; color: var(--text-primary); }
.rpt-toolbar-sub   { font-size: 11px; color: var(--text-tertiary); margin-top: 2px; }
.rpt-controls-right { display: flex; align-items: center; gap: 6px; flex-wrap: wrap; }

/* Control buttons used in reporting toolbar */
.ctl {
  padding: 5px 10px;
  font-size: 12px;
  font-weight: 500;
  color: var(--text-secondary);
  background: white;
  border: 1px solid var(--border-medium, #cbd5e1);
  border-radius: 6px;
  cursor: pointer;
  font-family: inherit;
  white-space: nowrap;
  transition: all .12s;
}
.ctl:hover { background: #f1f5f9; color: var(--text-primary); border-color: #94a3b8; }
.ctl.on, .ctl.active { background: var(--accent, #2563eb); color: white; border-color: var(--accent, #2563eb); font-weight: 600; }
.date-range-btn {
  padding: 5px 10px;
  font-size: 12px;
  font-weight: 500;
  color: var(--text-primary);
  background: white;
  border: 1px solid var(--border-medium, #cbd5e1);
  border-radius: 6px;
  cursor: pointer;
  font-family: inherit;
  white-space: nowrap;
}
.date-range-btn:hover { border-color: var(--accent); }

/* ── Date picker (hidden until toggled) ── */
.rpt-datepicker {
  display: none;
  align-items: center;
  gap: 10px;
  padding: 8px 24px;
  background: #f8faff;
  border-top: 1px solid #e0e7ff;
  flex-wrap: wrap;
}
/* Override any inherited label styles specifically inside datepicker */
.rpt-datepicker label,
.rpt-datepicker .rpt-dp-label {
  display: inline !important;
  font-size: 12px !important;
  font-weight: 600 !important;
  text-transform: none !important;
  color: var(--text-secondary) !important;
  margin: 0 !important;
  padding: 0 !important;
}
.rpt-datepicker input[type=date] {
  width: auto;
  padding: 5px 8px;
  border: 1px solid var(--border-medium, #cbd5e1);
  border-radius: 6px;
  font-size: 12px;
  font-family: inherit;
  color: var(--text-primary);
  background: white;
}

/* ── Tab bar ── */
.rpt-tabs {
  display: flex;
  border-top: 1px solid var(--border-light);
  padding: 0 24px;
  background: white;
  overflow-x: auto;
}
.rpt-tab {
  padding: 10px 20px;
  font-size: 13px;
  font-weight: 500;
  color: var(--text-secondary);
  background: none;
  border: none;
  border-bottom: 2px solid transparent;
  cursor: pointer;
  white-space: nowrap;
  font-family: inherit;
  transition: color .15s, border-color .15s;
  margin-bottom: -1px;
}
.rpt-tab:hover { color: var(--text-primary); }
.rpt-tab.active { color: var(--accent); border-bottom-color: var(--accent); font-weight: 600; }

/* ── Content body below sticky ── */
.rpt-body { padding: 24px 24px 60px; background: #f7f8fa; min-height: calc(100vh - 200px); }

/* ── Table wrapper ── */
.rpt-table-outer {
  width: 100%;
  overflow-x: auto;
}
.rpt-table-outer::-webkit-scrollbar { height: 5px; }
.rpt-table-outer::-webkit-scrollbar-thumb { background: var(--border-medium); border-radius: 3px; }
.rpt-table-wrap {
  display: inline-block; /* shrink to table content width */
  min-width: 520px;      /* never collapse too small */
  border-radius: 10px;
  box-shadow: 0 1px 3px rgba(0,0,0,.08), 0 0 0 1px var(--border-light);
  background: white;
  vertical-align: top;
}
/* Table itself: auto width so it only takes what it needs */
.rpt-table { width: auto; border-collapse: collapse; font-size: 13px; }
/* First (concept) column: fixed generous width */
.rpt-table thead th.rpt-th-first { min-width: 240px; max-width: 380px; }
.rpt-table tbody td.rpt-td-first,
.rpt-table tbody td.rpt-td-sub { min-width: 240px; max-width: 380px; }
/* Numeric columns: fixed compact width */
.rpt-table thead th.rpt-th,
.rpt-table thead th.rpt-th-total { min-width: 100px; width: 100px; }
.rpt-table tbody td.rpt-td { min-width: 100px; width: 100px; }

/* Header */
.rpt-table thead tr { background: #0f172a; }
.rpt-table thead th {
  padding: 11px 16px;
  font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: .5px;
  color: #94a3b8; text-align: right; white-space: nowrap;
  border-right: 1px solid rgba(255,255,255,.07);
}
.rpt-table thead th:last-child { border-right: none; }
.rpt-table thead th.rpt-th-first {
  text-align: left; color: #cbd5e1;
  position: sticky; left: 0; background: #0f172a; z-index: 2;
}
.rpt-table thead th.rpt-th-total { color: #60a5fa; }
.rpt-th-inner { display: flex; flex-direction: column; align-items: flex-end; gap: 3px; }
.rpt-th-bar   { width: 18px; height: 3px; border-radius: 2px; }

/* Body */
.rpt-table tbody tr { border-bottom: 1px solid #f1f5f9; }
.rpt-table tbody tr:last-child { border-bottom: none; }
.rpt-table tbody tr:hover { background: #f7f9ff; }
.rpt-table tbody tr.rpt-cat-row { background: #f8fafc; cursor: pointer; }
.rpt-table tbody tr.rpt-cat-row:hover { background: #eef2ff; }
.rpt-table tbody tr.rpt-cat-row td { font-weight: 700; }
.rpt-table tbody tr.rpt-tot-row { background: #0f172a !important; border-top: 2px solid var(--accent) !important; }
.rpt-table tbody tr.rpt-tot-row td { color: white; font-weight: 700; font-size: 12px; padding: 12px 16px; }
.rpt-table tbody tr.rpt-tot-row td.rpt-tot-label {
  color: #94a3b8; text-transform: uppercase; letter-spacing: .5px; font-size: 10px;
  position: sticky; left: 0; background: #0f172a; z-index: 1;
}
.rpt-table tbody tr.rpt-tot-row td.rpt-tot-num { text-align: right; }

/* Cells */
.rpt-td { padding: 9px 16px; text-align: right; white-space: nowrap; font-variant-numeric: tabular-nums; }
.rpt-td.rpt-td-first { text-align: left; position: sticky; left: 0; background: inherit; z-index: 1; }
.rpt-td.rpt-td-sub   { text-align: left; position: sticky; left: 0; background: inherit; z-index: 1; padding-left: 36px; }
.rpt-table tbody tr.rpt-cat-row td.rpt-td-first { background: #f1f5f9; }
.rpt-table tbody tr.rpt-cat-row:hover td.rpt-td-first { background: #e0e7ff; }
.rpt-nil { color: #c8d0dc; }
.rpt-hi  { color: var(--accent, #2563eb); font-weight: 700; }
.rpt-gn  { color: #16a34a; font-weight: 600; }

/* Expand button */
.rpt-xb {
  display: inline-flex; align-items: center; justify-content: center;
  width: 16px; height: 16px; border-radius: 4px;
  background: #e2e8f0; color: #64748b;
  font-size: 11px; font-weight: 700; cursor: pointer;
  border: 1px solid #cbd5e1; margin-right: 8px; flex-shrink: 0; vertical-align: middle;
  transition: all .12s;
}
.rpt-xb:hover { background: var(--accent); color: white; border-color: var(--accent); }

/* Detail rows */
.rpt-drow { display: none; }
.rpt-drow.open { display: table-row; }
.rpt-dc { padding: 0 !important; background: #eff6ff !important; }
.rpt-di { padding: 10px 16px 12px 40px; }
.rpt-di-label { font-size: 10px; font-weight: 700; color: #3b82f6; text-transform: uppercase; letter-spacing: .5px; margin-bottom: 6px; }
.rpt-dtxns { display: flex; flex-direction: column; gap: 3px; }
.rpt-dtx {
  display: grid; grid-template-columns: 100px 1fr 80px 90px; gap: 8px; align-items: center;
  padding: 4px 8px; border-radius: 5px; font-size: 11px; background: white; border: 1px solid #dbeafe;
}
.rpt-dtx:hover { background: #eff6ff; }
.rpt-dtx-d { color: #94a3b8; font-family: monospace; font-size: 10px; }
.rpt-dtx-c { color: var(--text-secondary); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.rpt-dtx-a { color: #94a3b8; font-size: 10px; text-align: right; }
.rpt-dtx-m { color: var(--text-primary); font-family: monospace; font-weight: 600; text-align: right; }
.rpt-dtx-m.rpt-gn { color: #16a34a; }

/* ── Multiselect filter bar ── */
.rpt-ms {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 16px;
  flex-wrap: wrap;
}
.rpt-ms-wrap {
  position: relative;
}
.rpt-ms-btn {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 12px;
  font-size: 13px;
  font-family: inherit;
  font-weight: 500;
  color: var(--text-primary);
  background: white;
  border: 1px solid var(--border-medium);
  border-radius: 6px;
  cursor: pointer;
  white-space: nowrap;
  min-width: 160px;
  transition: border-color .15s;
}
.rpt-ms-btn:hover { border-color: var(--accent); }
.rpt-ms-btn svg { margin-left: auto; color: var(--text-tertiary); flex-shrink: 0; }
.rpt-ms-panel {
  display: none;
  position: absolute;
  top: calc(100% + 4px);
  left: 0;
  min-width: 240px;
  max-height: 360px;
  overflow-y: auto;
  background: white;
  border: 1px solid var(--border-light);
  border-radius: 8px;
  box-shadow: 0 4px 16px rgba(0,0,0,.12);
  z-index: 200;
  padding: 6px 0;
}
.rpt-ms-panel.open { display: block; }
.rpt-ms-panel::-webkit-scrollbar { width: 4px; }
.rpt-ms-panel::-webkit-scrollbar-thumb { background: var(--border-medium); border-radius: 2px; }
/* Search box inside panel for long lists */
.rpt-ms-search {
  display: block;
  width: calc(100% - 24px);
  margin: 6px 12px;
  padding: 5px 9px;
  font-size: 12px;
  font-family: inherit;
  border: 1px solid var(--border-medium);
  border-radius: 5px;
  outline: none;
  color: var(--text-primary);
  background: var(--bg-secondary, #f8fafc);
}
.rpt-ms-search:focus { border-color: var(--accent); }
.rpt-ms-opt {
  display: flex;
  align-items: center;
  gap: 9px;
  padding: 7px 14px;
  font-size: 13px;
  cursor: pointer;
  color: var(--text-primary);
  transition: background .1s;
}
.rpt-ms-opt:hover { background: #f1f5f9; }
.rpt-ms-opt input[type=checkbox] { width: 14px; height: 14px; accent-color: var(--accent); cursor: pointer; flex-shrink: 0; }
.rpt-ms-all { font-weight: 600; }
.rpt-ms-divider { height: 1px; background: var(--border-light); margin: 4px 0; }
.rpt-sel-label { font-size: 12px; font-weight: 600; color: var(--text-secondary); white-space: nowrap; }

/* Category selector (legacy, kept for compat) */
.rpt-cat-sel { display: flex; align-items: center; gap: 10px; margin-bottom: 16px; }

/* Empty state */
.rpt-empty {
  text-align: center; padding: 48px 24px; color: var(--text-tertiary); font-size: 13px;
  background: white; border-radius: 10px; border: 1px solid var(--border-light);
}


/* ── Plan propagation button & panel ─────────────────────────── */
.prop-btn {
  position: absolute;
  left: 4px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 10px;
  color: #94a3b8;
  cursor: pointer;
  line-height: 1;
  padding: 2px;
  border-radius: 3px;
  transition: color .15s;
  user-select: none;
}
.prop-btn:hover { color: var(--accent, #2563eb); }

/* Overlay */
.prop-panel-overlay {
  position: fixed; inset: 0; z-index: 1000;
  background: rgba(15,23,42,.25);
  display: flex; align-items: center; justify-content: center;
}
.prop-panel {
  background: white;
  border-radius: 14px;
  box-shadow: 0 8px 32px rgba(0,0,0,.14);
  padding: 24px;
  min-width: 340px;
  max-width: 420px;
  width: 100%;
}
.prop-panel-header {
  display: flex; justify-content: space-between; align-items: center;
  margin-bottom: 6px; font-size: 14px; color: var(--text-primary);
}
.prop-panel-close {
  background: none; border: none; font-size: 18px; cursor: pointer;
  color: var(--text-secondary); padding: 0 4px; line-height: 1;
}
.prop-panel-sub {
  font-size: 12px; color: var(--text-secondary);
  margin-bottom: 20px; padding-bottom: 16px;
  border-bottom: 1px solid var(--border-light);
}
.prop-panel-opts {
  display: flex; flex-direction: column; gap: 8px; margin-bottom: 16px;
}
.prop-opt {
  display: flex; flex-direction: column; align-items: flex-start;
  padding: 12px 16px; border-radius: 10px;
  border: 1.5px solid var(--border-light);
  background: white; cursor: pointer;
  text-align: left; font-family: inherit;
  transition: border-color .15s, background .15s;
}
.prop-opt:hover { border-color: var(--accent, #2563eb); background: #f0f6ff; }
.prop-opt.active { border-color: var(--accent, #2563eb); background: #eff6ff; }
.prop-opt-label { font-size: 13px; font-weight: 600; color: var(--text-primary); }
.prop-opt-sub   { font-size: 11px; color: #94a3b8; margin-top: 2px; }
.prop-opt.active .prop-opt-label { color: var(--accent, #2563eb); }
.prop-panel-hint {
  font-size: 11px; color: #94a3b8; text-align: center; margin: 0;
}

/* ── Plan vs Real typographic differentiation (Option A) ──────── */
.budget-grid tbody td.td-plan {
  color: #94a3b8;
  font-weight: 400;
}
.budget-grid tbody td.td-real {
  color: #0f172a;
  font-weight: 600;
}
/* Keep current-month and closed-month overrides readable */
.budget-grid tbody td.td-plan.cur  { color: #78716c; }
.budget-grid tbody td.td-plan.closed { color: #94a3b8; }
.budget-grid tbody td.td-real.cur  { color: #1c1917; }

/* ── Total rows: mid-dark slate, distinct from both Plan and Real ── */
.budget-grid tbody td.td-tot {
  color: #475569;
  font-weight: 700;
}
.budget-grid tbody td.td-tot.cur    { color: #334155; }
.budget-grid tbody td.td-tot.closed { color: #64748b; }

/* ══════════════════════════════════════════════════════
   BUDGET TOOLBAR — Year nav + Search bar
   ══════════════════════════════════════════════════════ */
.bg-toolbar {
  display: flex;
  align-items: center;
  gap: 16px;
  margin-bottom: 12px;
  padding: 0 2px;
}
.bg-toolbar-year {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  background: var(--bg-tertiary);
  border-radius: 20px;
  padding: 4px 14px;
  flex-shrink: 0;
}
.bg-yr-btn {
  background: none; border: none; font-size: 15px; cursor: pointer;
  padding: 3px 7px; color: var(--text-secondary); border-radius: 12px;
  transition: background .15s;
}
.bg-yr-btn:hover { background: var(--border-light); }
.bg-yr-label {
  font-weight: 700; font-size: 14px; min-width: 40px; text-align: center;
  color: var(--text-primary);
}
.bg-toolbar-search {
  display: flex;
  align-items: center;
  gap: 0;
  flex: 1;
  max-width: 380px;
  background: var(--bg-secondary);
  border: 1.5px solid var(--border-light);
  border-radius: 10px;
  padding: 0 12px;
  transition: border-color .15s, box-shadow .15s;
}
.bg-toolbar-search:focus-within {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(59,130,246,.10);
}
.bg-search-icon {
  font-size: 16px; color: var(--text-tertiary); margin-right: 6px;
  flex-shrink: 0; line-height: 1; padding-top: 1px;
}
#bg-search {
  flex: 1; border: none; background: transparent;
  font-size: 13px; color: var(--text-primary);
  padding: 8px 0; outline: none; font-family: inherit;
}
#bg-search::placeholder { color: var(--text-tertiary); }
.bg-search-count {
  font-size: 11px; font-weight: 600; color: var(--accent);
  background: var(--accent-subtle, #eff6ff);
  border-radius: 10px; padding: 2px 8px; margin-left: 8px;
  white-space: nowrap; flex-shrink: 0;
  display: none;
}
.bg-search-count.visible { display: inline-block; }

/* ══════════════════════════════════════════════════════
   ANNUAL TOTAL COLUMN + RIGHT STICKY CONCEPTO
   ══════════════════════════════════════════════════════ */

/* Header */
.budget-grid thead th.th-total-hdr {
  background: #1e293b !important;
  color: #94a3b8 !important;
  font-size: 10px !important;
  letter-spacing: .08em;
  text-transform: uppercase;
  border-left: 3px solid #334155 !important;
}
.budget-grid thead th.th-total-sub {
  background: #1e293b !important;
  color: #64748b !important;
  font-size: 10px;
  font-weight: 500;
  border-left: 1px solid #334155;
}
.budget-grid thead th.th-total-sub-real {
  color: #94a3b8 !important;
}
.budget-grid thead th.th-right-hdr {
  background: #0f172a !important;
  border-left: 3px solid #334155 !important;
  min-width: 160px;
}

/* Data rows — Plan total */
.budget-grid tbody td.td-annual-plan {
  background: #f8fafc !important;
  color: #94a3b8;
  font-size: 11px;
  text-align: right;
  padding-right: 6px;
  white-space: nowrap;
  border-left: 3px solid #e2e8f0;
  font-variant-numeric: tabular-nums;
}
/* Data rows — Real total (emphasis) */
.budget-grid tbody td.td-annual-real {
  background: #f1f5f9 !important;
  color: #1e293b;
  font-size: 12px;
  font-weight: 700;
  text-align: right;
  padding-right: 8px;
  white-space: nowrap;
  font-variant-numeric: tabular-nums;
  border-right: 3px solid #e2e8f0;
}
.budget-grid tbody tr:hover td.td-annual-plan { background: #f1f5f9 !important; }
.budget-grid tbody tr:hover td.td-annual-real { background: #e8eef4 !important; }

/* Total rows */
.budget-grid .bg-total td.td-annual-plan {
  background: #f8fafc !important;
  color: #64748b;
  font-weight: 700;
  border-left: 3px solid #cbd5e1;
}
.budget-grid .bg-total td.td-annual-real {
  background: #e2e8f0 !important;
  color: #0f172a;
  font-weight: 800;
  font-size: 12px;
  border-right: 3px solid #cbd5e1;
}

/* Right sticky concepto column */
.budget-grid tbody td.td-right-name {
  position: sticky;
  right: 0;
  z-index: 3;
  background: #f8fafc !important;
  border-left: 3px solid #e2e8f0;
  min-width: 160px;
  max-width: 220px;
  text-align: left;
  font-size: 11px;
  color: #64748b;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-left: 10px !important;
}
.budget-grid tbody tr:hover td.td-right-name { background: #f1f5f9 !important; color: #334155; }
.budget-grid .bg-total td.td-right-tot {
  position: sticky;
  right: 0;
  z-index: 3;
  background: #f1f5f9 !important;
  border-left: 3px solid #cbd5e1;
  min-width: 160px;
  font-size: 12px;
  color: #1e293b;
  padding-left: 10px !important;
}
.budget-grid thead th.th-right-frozen {
  position: sticky; right: 0; z-index: 6;
}
.budget-grid tbody td.td-right-name { position: sticky; right: 0; z-index: 3; }
